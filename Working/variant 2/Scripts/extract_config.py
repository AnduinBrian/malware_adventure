def decrypt_c2(enc, key, const):
    dec = ""
    for c in enc:
        for i in key:
            c = c ^ i
        dec += chr(c ^ const)
    return dec

def extract_c2(startEA, amount, const):
    data_offset = []
    amount = int(amount)
    offset = get_bytes(startEA, amount * 8)
    for i in range(0,len(offset) -1, 8):
        a = offset[i:i+8:]
        data_offset.append(struct.unpack("<Q",a)[0])
    for i in data_offset:
        data_len = get_bytes(i,1)
        data_len = struct.unpack("<B", data_len)[0]
        key = get_bytes(i + data_len + 1, 4)
        enc = get_bytes(i + 1, data_len)
        print(decrypt_c2(enc,key, const))
